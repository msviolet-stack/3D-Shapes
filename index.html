<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cube ‚Üí Net Explorer (Kids)</title>

  <!-- ‚úÖ Import map fixes: "Failed to resolve module specifier 'three'" -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/": "https://unpkg.com/three@0.160.0/"
    }
  }
  </script>

  <style>
    :root{
      --ink:#1b2150;
      --panel:#ffffffd6;
      --shadow: 0 12px 30px rgba(0,0,0,.12);
    }
    *{ box-sizing:border-box; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body{
      margin:0;
      color: var(--ink);
      background: linear-gradient(135deg, #ffe6ff 0%, #e6f6ff 30%, #eaffef 60%, #fff5dc 100%);
    }
    .wrap{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:16px;
      height:100vh;
      padding:16px;
    }
    .panel{
      background: var(--panel);
      border: 2px solid rgba(27,33,80,.10);
      border-radius:18px;
      padding:16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }
    h1{ font-size:20px; margin:0 0 8px; }
    p{ margin:8px 0; line-height:1.35; }
    .btn{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border: 2px solid rgba(27,33,80,.15);
      background: linear-gradient(135deg, #6ea8ff, #8bffb0);
      color:#062046;
      font-weight:900;
      cursor:pointer;
      transition:.12s transform;
      box-shadow: 0 10px 18px rgba(35,80,170,.18);
    }
    .btn:hover{ transform: translateY(-1px); }
    .row{ margin-top:14px; }
    label{ display:block; font-weight:900; margin-bottom:8px; }
    input[type="range"]{ width:100%; }
    .small{ font-size:12px; opacity:.85; }

    .canvas{
      background: radial-gradient(circle at 20% 10%, #ffffff 0%, #f6fbff 35%, #f2fff7 70%, #fffaf0 100%);
      border: 2px solid rgba(27,33,80,.10);
      border-radius:18px;
      overflow:hidden;
      position:relative;

      /* ‚úÖ Give a real height so the renderer shows */
      height: calc(100vh - 32px);
      box-shadow: var(--shadow);
    }
    .hint{
      position:absolute; left:12px; bottom:12px;
      background:#ffffffdd;
      border:2px solid rgba(27,33,80,.10);
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
    }

    .chipRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .chip{
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      background:#ffffff;
      border:2px solid rgba(27,33,80,.10);
      box-shadow: 0 8px 14px rgba(0,0,0,.06);
      user-select:none;
    }

    @media (max-width: 900px){
      .wrap{ grid-template-columns: 1fr; height:auto; }
      .canvas{ height: 65vh; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="panel">
      <h1>üßä Cube ‚Üí Net Explorer</h1>
      <p>
        Click <b>Show Cube</b>. Drag the slider to open the cube into a net.
        Drag your mouse on the right to rotate it.
      </p>

      <button id="btnCube" class="btn">Show Cube</button>

      <div class="row">
        <label for="openSlider">Open the cube</label>
        <input id="openSlider" type="range" min="0" max="100" value="0" />
        <p class="small">0 = folded cube ‚Ä¢ 100 = flat net</p>
      </div>

      <div class="chipRow" aria-hidden="true">
        <div class="chip">üëÜ Drag to rotate</div>
        <div class="chip">üñ±Ô∏è Scroll to zoom</div>
        <div class="chip">üéöÔ∏è Slider opens net</div>
      </div>

      <p class="small">
        Tip: Put this file as <b>index.html</b> in your repo root, then enable <b>GitHub Pages</b>.
      </p>
    </div>

    <div class="canvas" id="view">
      <div class="hint">Mouse: drag to rotate ‚Ä¢ Scroll: zoom</div>
    </div>
  </div>

  <script type="module">
    import * as THREE from "three";
    import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";

    const container = document.getElementById("view");
    const btnCube = document.getElementById("btnCube");
    const slider = document.getElementById("openSlider");

    // --- Scene ---
    const scene = new THREE.Scene();

    // --- Camera ---
    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 100);
    camera.position.set(3.4, 2.4, 4.6);

    // --- Renderer ---
    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    container.appendChild(renderer.domElement);

    // --- Controls ---
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.08;
    controls.minDistance = 2.2;
    controls.maxDistance = 12;
    controls.target.set(0.5, 0.1, 0);

    // --- Lights (bright & friendly) ---
    scene.add(new THREE.AmbientLight(0xffffff, 0.95));
    const dir = new THREE.DirectionalLight(0xffffff, 1.15);
    dir.position.set(5, 7, 4);
    scene.add(dir);
    const hemi = new THREE.HemisphereLight(0xbad1ff, 0xffffff, 0.7);
    scene.add(hemi);

    // Soft grid for orientation (optional)
    const grid = new THREE.GridHelper(10, 10, 0x9db6ff, 0xdfe9ff);
    grid.position.y = -1.2;
    scene.add(grid);

    // --- Cube/Net Build ---
    const root = new THREE.Group();
    scene.add(root);

    const size = 1;
    const half = size / 2;

    // Kid-friendly colors per face
    const COLORS = {
      center: 0x6ea8ff,
      right:  0xff8b8b,
      left:   0x8bffb0,
      top:    0xffe08b,
      bottom: 0xc78bff,
      back:   0x8be6ff
    };

    function makeFace(colorHex){
      const geom = new THREE.PlaneGeometry(size, size);
      const mat = new THREE.MeshStandardMaterial({
        color: colorHex,
        roughness: 0.35,
        metalness: 0.05,
        side: THREE.DoubleSide
      });
      const mesh = new THREE.Mesh(geom, mat);

      // Outline for clarity
      const edges = new THREE.EdgesGeometry(geom);
      const outline = new THREE.LineSegments(
        edges,
        new THREE.LineBasicMaterial({ color: 0x1b2150, transparent:true, opacity:0.55 })
      );
      mesh.add(outline);

      return mesh;
    }

    // Hinge helper:
    // parentPivot: group to attach to
    // hingeEdgeOffset: where the hinge is located (pivot position)
    // faceOffset: where the face sits relative to the pivot
    function hingedFace(parentPivot, color, hingeEdgeOffset, faceOffset){
      const pivot = new THREE.Group();
      pivot.position.copy(hingeEdgeOffset);
      parentPivot.add(pivot);

      const face = makeFace(color);
      face.position.copy(faceOffset);
      pivot.add(face);

      return pivot;
    }

    // Net layout:
    //      Top
    // Left Center Right Back
    //     Bottom
    const centerPivot = new THREE.Group();
    root.add(centerPivot);
    centerPivot.add(makeFace(COLORS.center));

    const rightPivot = hingedFace(
      centerPivot, COLORS.right,
      new THREE.Vector3( half, 0, 0),
      new THREE.Vector3( half, 0, 0)
    );

    const leftPivot = hingedFace(
      centerPivot, COLORS.left,
      new THREE.Vector3(-half, 0, 0),
      new THREE.Vector3(-half, 0, 0)
    );

    const topPivot = hingedFace(
      centerPivot, COLORS.top,
      new THREE.Vector3(0,  half, 0),
      new THREE.Vector3(0,  half, 0)
    );

    const bottomPivot = hingedFace(
      centerPivot, COLORS.bottom,
      new THREE.Vector3(0, -half, 0),
      new THREE.Vector3(0, -half, 0)
    );

    const backPivot = hingedFace(
      rightPivot, COLORS.back,
      new THREE.Vector3(size, 0, 0),
      new THREE.Vector3(half, 0, 0)
    );

    root.rotation.x = -0.18;
    root.rotation.y = 0.35;

    // Slider drives fold/unfold:
    // s=0 folded (90¬∞), s=1 flat (0¬∞)
    function applyOpenAmount(s){
      const a = (1 - s) * (Math.PI / 2);

      // Right/Left fold around Y axis
      rightPivot.rotation.y  = -a;
      leftPivot.rotation.y   =  a;

      // Top/Bottom fold around X axis
      topPivot.rotation.x    =  a;
      bottomPivot.rotation.x = -a;

      // Back folds too
      backPivot.rotation.y   = -a;
    }

    function showCube(){
      slider.value = "0";
      applyOpenAmount(0);
      camera.position.set(3.4, 2.4, 4.6);
      controls.target.set(0.5, 0.1, 0);
      controls.update();
    }

    btnCube.addEventListener("click", showCube);

    slider.addEventListener("input", () => {
      const s = Number(slider.value) / 100;
      applyOpenAmount(s);
    });

    // --- Resize (critical) ---
    function onResize(){
      const w = container.clientWidth;
      const h = container.clientHeight;
      renderer.setSize(w, h, false);
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
    }
    window.addEventListener("resize", onResize);
    onResize();

    // Start with cube shown (kids don't need to troubleshoot)
    showCube();

    // --- Animate ---
    function tick(){
      controls.update();
      renderer.render(scene, camera);
      requestAnimationFrame(tick);
    }
    tick();
  </script>
</body>
</html>
