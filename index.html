<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cube â†’ Net Explorer (Kids)</title>
  <style>
    :root{
      --ink:#1b2150;
      --panel:#ffffffcc;
      --panel2:#ffffff;
      --shadow: 0 12px 30px rgba(0,0,0,.12);
    }
    *{ box-sizing:border-box; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body{
      margin:0;
      color: var(--ink);
      background: linear-gradient(135deg, #ffe8ff 0%, #e8f5ff 35%, #eaffef 70%, #fff6df 100%);
    }
    .wrap{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:16px;
      height:100vh;
      padding:16px;
    }
    .panel{
      background: var(--panel);
      border: 2px solid rgba(27,33,80,.10);
      border-radius:18px;
      padding:16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }
    h1{ font-size:20px; margin:0 0 8px; }
    p{ margin:8px 0; line-height:1.35; }
    .btn{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border: 2px solid rgba(27,33,80,.15);
      background: linear-gradient(135deg, #6ea8ff, #8bffb0);
      color:#062046;
      font-weight:900;
      cursor:pointer;
      transition:.12s transform;
      box-shadow: 0 10px 18px rgba(35,80,170,.18);
    }
    .btn:hover{ transform: translateY(-1px); }
    .row{ margin-top:14px; }
    label{ display:block; font-weight:900; margin-bottom:8px; }
    input[type="range"]{ width:100%; }
    .small{ font-size:12px; opacity:.85; }
    .canvas{
      background: radial-gradient(circle at 20% 10%, #ffffff 0%, #f6fbff 35%, #f2fff7 70%, #fffaf0 100%);
      border: 2px solid rgba(27,33,80,.10);
      border-radius:18px;
      overflow:hidden;
      position:relative;
      height: calc(100vh - 32px); /* IMPORTANT: gives the renderer real height */
      box-shadow: var(--shadow);
    }
    .hint{
      position:absolute; left:12px; bottom:12px;
      background:#ffffffdd;
      border:2px solid rgba(27,33,80,.10);
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
    }
    .error{
      position:absolute; inset:12px;
      background:#fff1f1;
      border:2px solid #ffb3b3;
      border-radius:14px;
      padding:12px;
      display:none;
      white-space:pre-wrap;
      overflow:auto;
    }
    @media (max-width: 900px){
      .wrap{ grid-template-columns: 1fr; height:auto; }
      .canvas{ height: 65vh; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <h1>ðŸ§Š Cube â†’ Net Explorer</h1>
      <p>
        Drag the slider to open the cube into a net.
        Drag your mouse on the right to rotate it.
      </p>

      <button id="btnCube" class="btn">Show Cube</button>

      <div class="row">
        <label for="openSlider">Open the cube</label>
        <input id="openSlider" type="range" min="0" max="100" value="0" />
        <p class="small">0 = folded cube â€¢ 100 = flat net</p>
      </div>

      <p class="small">
        If you canâ€™t see anything, make sure youâ€™re viewing it on GitHub Pages (not by double-clicking the file).
      </p>
    </div>

    <div class="canvas" id="view">
      <div class="hint">Mouse: drag to rotate â€¢ Scroll: zoom</div>
      <div class="error" id="errBox"></div>
    </div>
  </div>

  <script type="module">
    const errBox = document.getElementById("errBox");
    function showError(msg){
      errBox.style.display = "block";
      errBox.textContent =
`âš ï¸ I couldnâ€™t load the 3D libraries.

Most likely cause:
â€¢ You opened the file directly (file://...) instead of using GitHub Pages or a local server.

Fix:
â€¢ Use GitHub Pages OR run a local server (VS Code â†’ Live Server).

Details:
${msg}`;
    }

    let THREE, OrbitControls;
    try{
      THREE = await import("https://unpkg.com/three@0.160.0/build/three.module.js");
      ({ OrbitControls } = await import("https://unpkg.com/three@0.160.0/examples/jsm/controls/OrbitControls.js"));
    }catch(e){
      showError(String(e));
      throw e;
    }

    const container = document.getElementById("view");
    const btnCube = document.getElementById("btnCube");
    const slider = document.getElementById("openSlider");

    // Scene
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 100);
    camera.position.set(3.4, 2.4, 4.6);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    container.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.08;
    controls.minDistance = 2.2;
    controls.maxDistance = 12;
    controls.target.set(0.5, 0.1, 0);

    // Friendly bright lights
    scene.add(new THREE.AmbientLight(0xffffff, 0.9));
    const dir = new THREE.DirectionalLight(0xffffff, 1.1);
    dir.position.set(5, 7, 4);
    scene.add(dir);

    // A subtle floor grid for â€œorientationâ€
    const grid = new THREE.GridHelper(10, 10, 0x9db6ff, 0xdfe9ff);
    grid.position.y = -1.2;
    scene.add(grid);

    // Root group
    const root = new THREE.Group();
    scene.add(root);

    const size = 1;
    const half = size / 2;

    // Kid-friendly colors per face
    const colors = {
      center: 0x6ea8ff,
      right:  0xff8b8b,
      left:   0x8bffb0,
      top:    0xffe08b,
      bottom: 0xc78bff,
      back:   0x8be6ff
    };

    function makeFace(colorHex){
      const geom = new THREE.PlaneGeometry(size, size);
      const mat = new THREE.MeshStandardMaterial({
        color: colorHex,
        roughness: 0.35,
        metalness: 0.05,
        side: THREE.DoubleSide
      });

      const mesh = new THREE.Mesh(geom, mat);

      const edges = new THREE.EdgesGeometry(geom);
      const line = new THREE.LineSegments(
        edges,
        new THREE.LineBasicMaterial({ color: 0x1b2150, transparent:true, opacity:0.55 })
      );
      mesh.add(line);

      return mesh;
    }

    // Hinge helper
    function hingedFace(parentPivot, color, hingeAxis, hingeEdgeOffsetVec3, faceOffsetVec3){
      const pivot = new THREE.Group();
      pivot.position.copy(hingeEdgeOffsetVec3);
      parentPivot.add(pivot);

      const face = makeFace(color);
      face.position.copy(faceOffsetVec3);
      pivot.add(face);

      return { pivot, hingeAxis };
    }

    const centerPivot = new THREE.Group();
    root.add(centerPivot);
    centerPivot.add(makeFace(colors.center));

    // Net layout:
    //    Top
    // Left Center Right Back
    //   Bottom
    const right = hingedFace(centerPivot, colors.right, "y",
      new THREE.Vector3( half, 0, 0), new THREE.Vector3( half, 0, 0));

    const left = hingedFace(centerPivot, colors.left, "y",
      new THREE.Vector3(-half, 0, 0), new THREE.Vector3(-half, 0, 0));

    const top = hingedFace(centerPivot, colors.top, "x",
      new THREE.Vector3(0,  half, 0), new THREE.Vector3(0,  half, 0));

    const bottom = hingedFace(centerPivot, colors.bottom, "x",
      new THREE.Vector3(0, -half, 0), new THREE.Vector3(0, -half, 0));

    const back = hingedFace(right.pivot, colors.back, "y",
      new THREE.Vector3(size, 0, 0), new THREE.Vector3(half, 0, 0));

    root.rotation.x = -0.18;
    root.rotation.y = 0.35;

    // Slider â†’ fold/unfold
    function applyOpenAmount(s){
      // s=0 folded (90Â°), s=1 flat (0Â°)
      const a = (1 - s) * (Math.PI / 2);

      right.pivot.rotation.y  = -a;
      left.pivot.rotation.y   =  a;
      top.pivot.rotation.x    =  a;
      bottom.pivot.rotation.x = -a;
      back.pivot.rotation.y   = -a;
    }

    // Show cube
    function showCube(){
      slider.value = "0";
      applyOpenAmount(0);
      controls.update();
    }

    btnCube.addEventListener("click", showCube);

    slider.addEventListener("input", () => {
      const s = Number(slider.value) / 100;
      applyOpenAmount(s);
    });

    // Resize (very important)
    function onResize(){
      const w = container.clientWidth;
      const h = container.clientHeight;
      renderer.setSize(w, h, false);
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
    }
    window.addEventListener("resize", onResize);
    onResize();

    // Start with cube visible immediately (kid-friendly)
    showCube();

    function tick(){
      controls.update();
      renderer.render(scene, camera);
      requestAnimationFrame(tick);
    }
    tick();
  </script>
</body>
</html>
